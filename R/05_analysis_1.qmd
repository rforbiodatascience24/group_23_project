---
title: "05_analysis_1"
format: html
editor: visual
---

# Pre-analysis

Before going into descriptive statistics, we analyze the general trend of the data to understand what we're dealing with.

## Loading libraries

```{r}
#| message: false
library("tidyverse")
library("viridis")
library("patchwork")
```

## Loading data

```{r}
first_path <- "~/projects/R_project/"
file_path <- "data/03_dat_aug.tsv" 
file_path <- file.path(first_path, file_path)

df_aug <- read_tsv(file = file_path)
```

## Analysis

First, we count the occurance of each class in the dataset. The classes are the following:

1.  **c-CS-s**: control mice, stimulated to learn, injected with saline

2.  **c-CS-m**: control mice, stimulated to learn, injected with memantine

3.  **c-SC-s**: control mice, not stimulated to learn, injected with saline

4.  **c-SC-m**: control mice, not stimulated to learn, injected with memantine

5.  **t-CS-s**: trisomy mice, stimulated to learn, injected with saline

6.  **t-CS-m**: trisomy mice, stimulated to learn, injected with memantine

7.  **t-SC-s**: trisomy mice, not stimulated to learn, injected with saline

8.  **t-SC-m**: trisomy mice, not stimulated to learn, injected with memantine

```{r}
ggplot(data = df_aug,
       mapping = aes(class, 
                     fill = class)) +
  geom_bar(alpha = 0.8) +
  scale_fill_viridis_d(option = "D") +
  theme_light(base_family = "Avenir") +
  labs(title = "Count of each class")
```

Going into details, we pick the two proteins that we used to create the model in 04_describe (BRAF_N and pERK_N), and we analize their expression levels based on the class.

```{r fig.width=8, fig.height=10}
p1 <- ggplot(data = df_aug,
       mapping = aes(x = class,
                     y = BRAF_N,
                     fill = class)) +
  geom_boxplot(alpha = 0.8) +
  scale_fill_viridis_d(option = "D") +
  theme_light(base_family = "Avenir") +
  scale_y_continuous(limits = c(0, 3.75))

p2 <- ggplot(data = df_aug,
       mapping = aes(x = class,
                     y = pERK_N,
                     fill = class)) +
  geom_boxplot(alpha = 0.8) +
  scale_fill_viridis_d(option = "D") +
  theme_light(base_family = "Avenir") +
  scale_y_continuous(limits = c(0, 3.75))

p1 / p2 +
  plot_annotation(title = "Distribution of Protein Expression Level by Class") &
  theme(plot.title = element_text(size = 15, 
                                   family = "Avenir"))
```

We may notice that just a few of the boxplots are similar between the two proteins.

In particular, pERK_N is characterized by slightly larger boxplots at higher values, which suggests that this protein is expressed in a more various way. Moreover, its whiskers are longer than those of BRAF_N. However, they both present most of the outliers for c-CS-s class and a very small variance for c-SC-m and c-SC-s classes.

--\> needs to be checked
