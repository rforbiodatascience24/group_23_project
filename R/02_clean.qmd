---
title: "02_clean"
format: html
editor: visual
---

## Loading libraries

```{r}
library("tidyverse")
```

## Loading data

```{r}
#first_path <- "/net/pupil1/home/people/s242150/projects/R_project/"
#file_path <- file.path(first_path, "data/01_dat_load.tsv")
#df <-  read_tsv(file = file_path)
df <- read_tsv(file = "data/01_dat_load.tsv")

```

## Cleaning data

```{r}
# I'm not sure if this is necessary to deal with the NAs
#df_clean <- df |>
  #mutate(across(everything(), ~ ifelse(is.na(.), "N/A", .)))
```

Checking how many missing values appear in each column.

```{r}
missing_summary <- colSums(is.na(df))
print(missing_summary)
```

Removing the columns with a significant number of missing values compared with the size of the dataset (chosen threshold: \>100 NAs).

```{r}
df_clean <- df |> 
  select(-"BAD_N", 
         -"H3AcK18_N", 
         -"BCL2_N", 
         -"EGR1_N", 
         -"H3MeK4_N")
```

```{r}
# Alternative to automatize this step (no missing_summary needed):
# select(where(~ sum(is.na(.)) < 100))
```

Creating the cleaned tsv file.

```{r}
#full_path <- file.path(first_path, "data/02_dat_clean.tsv")

df_clean |>
  write_tsv(file = "data/02_dat_clean.tsv")
  #write_tsv(file = full_path)
```
